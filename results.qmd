# Results

```{r, message=FALSE, warning=FALSE}
# Load necessary libraries
library(tidyverse, quietly = TRUE)
library(ggplot2)

data <- read.csv("DQS_Death_rates_for_suicide__by_sex__race__Hispanic_origin__and_age__United_States_from_CDC_WONDER_20241119.csv")
```

## Trends Over Time
```{r}
# Define a function to plot suicide rates by subgroup without faceting
plot_suicide_rates_combined <- function(data, group_id) {
  # Filter for only one method of ESTIMATE calculation
  filtered_data <- data %>%
    filter(ESTIMATE_TYPE_ID == 2)
  
  # Filter data based on the input group_id
  filtered_data <- filtered_data %>%
    filter(GROUP_ID == group_id)
  
  # Extract the group name for the given group_id
  group_name <- unique(filtered_data$GROUP)
  
  # Create the combined plot
  ggplot(filtered_data, aes(x = TIME_PERIOD, y = ESTIMATE, color = SUBGROUP, group = SUBGROUP)) +
    geom_line(size = 1) +
    geom_point(size = 1) +
    labs(
      title = paste("Suicide Rates by", group_name, "Over Time"),
      x = "Year",
      y = "Suicide Rate (per 100,000)",
      color = "Subgroup"
    ) +
    theme_minimal() +
    theme(
      legend.position = "bottom",
      legend.title = element_text(size = 10),
      legend.text = element_text(size = 8),
      axis.text.x = element_text(angle = 45, hjust = 1)
    )
}
```
### Total

```{r}
plot_suicide_rates_combined(data, group_id = 1)
```
### Suicide Rates by Age Group Over Time

```{r}
plot_suicide_rates_combined(data, group_id = 2)
```

### Suicide Rates by Sex Group Over Time

```{r}
plot_suicide_rates_combined(data, group_id = 3)
```

### By Race

```{r}
# Create a dataset with combined race groups by averaging male and female estimates
combine_race_data <- function(data) {
  # Filter for "sex and race" group
  data <- data %>%
    filter(ESTIMATE_TYPE_ID == 2)
  
  race_data <- data %>%
    filter(GROUP == "Sex and race") %>%
    mutate(Race = case_when(
      SUBGROUP_ORDER %in% c(46, 50) ~ "American Indian and Alaska Native",
      SUBGROUP_ORDER %in% c(47, 51) ~ "Asian or Pacific Islander",
      SUBGROUP_ORDER %in% c(48, 52) ~ "Black",
      SUBGROUP_ORDER %in% c(49, 53) ~ "White",
      TRUE ~ NA_character_  # Exclude other categories
    )) %>%
    filter(!is.na(Race))  # Remove rows that are not part of the selected races
  
  # Group by Time Period and Race, then calculate the average estimate
  combined_race_data <- race_data %>%
    group_by(TIME_PERIOD, Race) %>%
    summarize(Avg_Estimate = mean(ESTIMATE, na.rm = TRUE), .groups = "drop")
  
  return(combined_race_data)
}

# Apply the function to your dataset
race_trend_data <- combine_race_data(data)

# Plot the trend over time by race
ggplot(race_trend_data, aes(x = TIME_PERIOD, y = Avg_Estimate, color = Race, group = Race)) +
  geom_line(size = 1) +
  geom_point(size = 1) +
  labs(
    title = "Suicide Rates by Race Over Time",
    x = "Year",
    y = "Average Suicide Rate (per 100,000)",
    color = "Race"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

```


### By Origin
```{r}
# Combine Hispanic and Non-Hispanic groups by averaging their respective SUBGROUP_IDs
hispanic_data <- data %>%
  filter(ESTIMATE_TYPE_ID == 2)

hispanic_data <- hispanic_data %>%
  filter(SUBGROUP_ORDER %in% c(54, 55, 56, 57, 58, 59, 60, 61, 62, 63)) %>%
  mutate(
    Hispanic_Group = case_when(
      SUBGROUP_ORDER %in% c(54, 59) ~ "Hispanic",
      SUBGROUP_ORDER %in% c(55, 56, 57, 58, 60, 61, 62, 63) ~ "Non-Hispanic"
    )
  ) %>%
  group_by(Hispanic_Group, TIME_PERIOD) %>%
  summarise(
    ESTIMATE = mean(ESTIMATE, na.rm = TRUE),
    .groups = "drop"
  )


# Plot Hispanic vs Non-Hispanic trends over time
ggplot(hispanic_data, aes(x = TIME_PERIOD, y = ESTIMATE, color = Hispanic_Group, group = Hispanic_Group)) +
  geom_line(size = 1) +
  geom_point(size = 1.5) +
  labs(
    title = "Trends in Suicide Rates: Hispanic vs Non-Hispanic Groups",
    x = "Year",
    y = "Suicide Rate (per 100,000)",
    color = "Group"
  ) +
  theme_minimal() +
  theme(
    legend.position = "bottom",
    legend.title = element_text(size = 10),
    legend.text = element_text(size = 8),
    axis.text.x = element_text(angle = 45, hjust = 1)
  )

```

The disparity in suicide rates between Hispanic and non-Hispanic populations is influenced by a combination of cultural, social, economic, and systemic factors. In Hispanic communities, strong familial and community support, often referred to as *familismo*, plays a protective role, providing emotional and social safety nets that may reduce the risk of suicide. Religious beliefs, particularly within Catholicism, often discourage suicide, adding another layer of protection. However, cultural stigma around mental health often prevents open discussion and limits access to mental health resources, which can both suppress suicide risk and lead to underreporting.

Economic challenges also contribute to these differences. Many Hispanic individuals face lower income levels, unstable employment, and limited access to healthcare, which can exacerbate mental health issues while also restricting their documentation and treatment. For Hispanic immigrants, acculturation stress, discrimination, and immigration-related fears add further mental health burdens. Among Hispanic youth, acculturation gaps between parents and children can lead to family conflict, which has been linked to higher suicide risk, particularly among second-generation youth.

The term *Hispanic* encompasses diverse populations, and suicide risk factors vary among subgroups. For instance, Puerto Ricans have been reported to experience higher suicide rates, particularly among youth, due to economic and social challenges. Conversely, Cuban Americans often display lower rates, possibly due to stronger economic stability and established community networks. Mexican Americans, the largest Hispanic group in the U.S., are heavily studied, with risk factors often tied to immigration and acculturation dynamics.

In summary, the lower suicide rates in Hispanic populations reflect protective cultural factors such as strong familial bonds and religious beliefs. However, socioeconomic challenges, acculturation stress, and limited access to mental health resources pose significant risks, particularly for certain subgroups and second-generation immigrants. Addressing these disparities requires culturally sensitive interventions, expanded mental health resources, and programs that strengthen family and community cohesion.














